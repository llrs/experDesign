<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="Distributes samples in batches while making batches homogeneous according to their description. Allows for an arbitrary number of variables, both numeric and categorical. For quality control it provides functions to subset a representative sample.">
<title>Design experiments for batches • experDesign</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Design experiments for batches">
<meta property="og:description" content="Distributes samples in batches while making batches homogeneous according to their description. Allows for an arbitrary number of variables, both numeric and categorical. For quality control it provides functions to subset a representative sample.">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:creator" content="@Lluis_Revilla">
<meta name="twitter:site" content="@Lluis_Revilla">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="index.html">experDesign</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.1.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="articles/experdesign.html">exprDesign</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/llrs/experDesign/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="experdesign">experDesign<a class="anchor" aria-label="anchor" href="#experdesign"></a>
</h1></div>
<!-- badges: start -->

<!-- badges: end -->
<p>The goal of experDesign is to help you decide which samples go in which batch, reducing the potential batch bias before performing an experiment. It provides three main functions :</p>
<ul>
<li>
<code><a href="reference/design.html">design()</a></code>: Randomize the samples according to their variables.</li>
<li>
<code><a href="reference/replicates.html">replicates()</a></code>: Selects some samples for replicates and randomizes the samples.</li>
<li>
<code><a href="reference/spatial.html">spatial()</a></code>: Randomize the samples on a spatial grid.</li>
</ul>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>To install the latest version on <a href="https://CRAN.R-project.org/package=experDesign" class="external-link">CRAN</a> use:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"experDesign"</span><span class="op">)</span></code></pre></div>
<p>You can install the development version from <a href="https://github.com/" class="external-link">GitHub</a> with:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># install.packages("devtools")</span>
<span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"llrs/experDesign"</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="example">Example<a class="anchor" aria-label="anchor" href="#example"></a>
</h2>
<p>We can use the survey dataset for the examples:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://experdesign.llrs.dev">"experDesign"</a></span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">survey</span>, package <span class="op">=</span> <span class="st">"MASS"</span><span class="op">)</span> 
<span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">survey</span><span class="op">)</span>
<span class="co">#&gt;      Sex Wr.Hnd NW.Hnd W.Hnd    Fold Pulse    Clap Exer Smoke Height      M.I</span>
<span class="co">#&gt; 1 Female   18.5   18.0 Right  R on L    92    Left Some Never 173.00   Metric</span>
<span class="co">#&gt; 2   Male   19.5   20.5  Left  R on L   104    Left None Regul 177.80 Imperial</span>
<span class="co">#&gt; 3   Male   18.0   13.3 Right  L on R    87 Neither None Occas     NA     &lt;NA&gt;</span>
<span class="co">#&gt; 4   Male   18.8   18.9 Right  R on L    NA Neither None Never 160.00   Metric</span>
<span class="co">#&gt; 5   Male   20.0   20.0 Right Neither    35   Right Some Never 165.00   Metric</span>
<span class="co">#&gt; 6 Female   18.0   17.7 Right  L on R    64   Right Some Never 172.72 Imperial</span>
<span class="co">#&gt;      Age</span>
<span class="co">#&gt; 1 18.250</span>
<span class="co">#&gt; 2 17.583</span>
<span class="co">#&gt; 3 16.917</span>
<span class="co">#&gt; 4 20.333</span>
<span class="co">#&gt; 5 23.667</span>
<span class="co">#&gt; 6 21.000</span></code></pre></div>
<p>The dataset has numeric, categorical values and some <code>NA</code>’s value.</p>
</div>
</div>
<div class="section level1">
<h1 id="picking-samples-for-each-batch">Picking samples for each batch<a class="anchor" aria-label="anchor" href="#picking-samples-for-each-batch"></a>
</h1>
<p>Imagine that we can only work in groups of 70, and we want to randomize by Sex, Smoke, Age, and by writing hand.<br>
There are 1.6543999^{61} combinations some of them would be have in a single experiment all the right handed students. We could measure all these combinations but we can try to find an optimum value.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># To reduce the variables used:</span>
<span class="va">omit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Wr.Hnd"</span>, <span class="st">"NW.Hnd"</span>, <span class="st">"Fold"</span>, <span class="st">"Pulse"</span>, <span class="st">"Clap"</span>, <span class="st">"Exer"</span>, <span class="st">"Height"</span>, <span class="st">"M.I"</span><span class="op">)</span>
<span class="op">(</span><span class="va">keep</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">survey</span><span class="op">)</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">survey</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">omit</span><span class="op">]</span><span class="op">)</span>
<span class="co">#&gt; [1] "Sex"   "W.Hnd" "Smoke" "Age"</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">survey</span><span class="op">[</span>, <span class="va">keep</span><span class="op">]</span><span class="op">)</span>
<span class="co">#&gt;      Sex W.Hnd Smoke    Age</span>
<span class="co">#&gt; 1 Female Right Never 18.250</span>
<span class="co">#&gt; 2   Male  Left Regul 17.583</span>
<span class="co">#&gt; 3   Male Right Occas 16.917</span>
<span class="co">#&gt; 4   Male Right Never 20.333</span>
<span class="co">#&gt; 5   Male Right Never 23.667</span>
<span class="co">#&gt; 6 Female Right Never 21.000</span>

<span class="co"># Looking for groups at most of 70 samples.</span>
<span class="va">index</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/design.html">design</a></span><span class="op">(</span>pheno <span class="op">=</span> <span class="va">survey</span>, size_subset <span class="op">=</span> <span class="fl">70</span>, omit <span class="op">=</span> <span class="va">omit</span><span class="op">)</span>
<span class="va">index</span>
<span class="co">#&gt; $SubSet1</span>
<span class="co">#&gt;  [1]   8  10  11  13  16  18  21  25  26  32  38  42  43  44  50  54  55  60  65</span>
<span class="co">#&gt; [20]  67  68  72  74  75  76  79  88  89  92  97 109 124 140 143 145 147 150 155</span>
<span class="co">#&gt; [39] 163 164 173 176 181 182 183 185 187 194 200 206 207 208 209 210 213 217 218</span>
<span class="co">#&gt; [58] 228 231 236</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $SubSet2</span>
<span class="co">#&gt;  [1]   2   3   7   9  12  15  20  23  28  36  37  39  45  49  51  52  57  59  61</span>
<span class="co">#&gt; [20]  63  64  66  69  70  71  82  84  85  86  99 100 104 112 114 115 119 126 135</span>
<span class="co">#&gt; [39] 137 146 153 159 160 166 169 171 174 175 180 186 191 195 204 211 215 219 221</span>
<span class="co">#&gt; [58] 227 232</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $SubSet3</span>
<span class="co">#&gt;  [1]   4   6  14  24  29  34  35  40  46  47  53  56  58  73  78  80  81  87  95</span>
<span class="co">#&gt; [20]  96  98 101 102 103 105 107 108 117 118 120 121 122 125 129 131 132 133 134</span>
<span class="co">#&gt; [39] 136 139 142 148 152 154 156 157 162 172 189 190 199 205 220 226 229 230 233</span>
<span class="co">#&gt; [58] 234 235</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $SubSet4</span>
<span class="co">#&gt;  [1]   1   5  17  19  22  27  30  31  33  41  48  62  77  83  90  91  93  94 106</span>
<span class="co">#&gt; [20] 110 111 113 116 123 127 128 130 138 141 144 149 151 158 161 165 167 168 170</span>
<span class="co">#&gt; [39] 177 178 179 184 188 192 193 196 197 198 201 202 203 212 214 216 222 223 224</span>
<span class="co">#&gt; [58] 225 237</span></code></pre></div>
<p>We can transform then into a vector to append to the file or to pass to the lab mate with:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="reference/batch_names.html">batch_names</a></span><span class="op">(</span><span class="va">index</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; [1] "SubSet4" "SubSet2" "SubSet2" "SubSet3" "SubSet4" "SubSet3"</span></code></pre></div>
</div>
<div class="section level1">
<h1 id="previous-work">Previous work<a class="anchor" aria-label="anchor" href="#previous-work"></a>
</h1>
<p>The CRAN task View of <a href="https://CRAN.R-project.org/view=ExperimentalDesign" class="external-link">Experimental Design</a> includes many packages relevant for designing an experiment before collecting data, but none of them provides how to manage them once the samples are already collected.</p>
<p>Two packages allow to distribute the samples on batches:</p>
<ul>
<li><p>The <a href="https://bioconductor.org/packages/release/bioc/html/OSAT.html" class="external-link">OSAT</a> package handles categorical variables but not numeric data. It doesn’t work with our data.</p></li>
<li><p>The <a href="https://github.com/m-Py/minDiff" class="external-link">minDiff</a> package reported in <a href="https://stats.stackexchange.com/a/326015/105234" class="external-link">Stats.SE</a>, handles both numeric and categorical data. But it can only optimize for two nominal criteria. It doesn’t work for our data.</p></li>
<li><p>The <a href="https://bioconductor.org/packages/Omixer/" class="external-link">Omixer</a> package handles both numeric and categorical data (converting categorical variables to numeric). But both the same way either Pearson’s Chi-squared Test if there are few samples or Kendall’s correlation. It does allow to protect some spots from being used.</p></li>
</ul>
<p>If you are still designing the experiment and do not have collected any data <a href="https://cran.r-project.org/package=DeclareDesign" class="external-link">DeclareDesign</a> might be relevant for you.</p>
<p>Question in <a href="https://bioinformatics.stackexchange.com/q/4765/48" class="external-link">Bioinformatics.SE</a> I made before developing the package.</p>
</div>
<div class="section level1">
<h1 id="other">Other<a class="anchor" aria-label="anchor" href="#other"></a>
</h1>
<p>Please note that this project is released with a <a href="https://www.contributor-covenant.org/version/1/0/0/code-of-conduct/" class="external-link">Contributor Code of Conduct</a>. By participating in this project you agree to abide by its terms.</p>
</div>

  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://cloud.r-project.org/package=experDesign" class="external-link">View on CRAN</a></li>
<li><a href="https://github.com/llrs/experDesign/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/llrs/experDesign/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>

<div class="community">
<h2 data-toc-skip>Community</h2>
<ul class="list-unstyled">
<li><a href="CODE_OF_CONDUCT.html">Code of conduct</a></li>
</ul>
</div>

<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing experDesign</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Lluís Revilla Sancho <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0001-9747-2570" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li><a href="authors.html">More about authors...</a></li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://CRAN.R-project.org/package=experDesign" class="external-link"><img src="https://www.r-pkg.org/badges/version/experDesign" alt="CRAN status"></a></li>
<li><a href="https://github.com/llrs/experDesign/actions?workflow=R-CMD-check" class="external-link"><img src="https://github.com/llrs/experDesign/workflows/R-CMD-check/badge.svg" alt="R build status"></a></li>
<li><a href="https://codecov.io/github/llrs/experDesign?branch=master" class="external-link"><img src="https://codecov.io/gh/llrs/experDesign/branch/master/graph/badge.svg" alt="Coverage status"></a></li>
<li><a href="https://lifecycle.r-lib.org/articles/stages.html#stable" class="external-link"><img src="https://img.shields.io/badge/lifecycle-stable-brightgreen.svg" alt="Lifecycle: stable"></a></li>
<li><a href="https://www.repostatus.org/#active" class="external-link"><img src="https://www.repostatus.org/badges/latest/active.svg" alt="Project Status: Active - The project has reached a stable, usable state and is being actively developed."></a></li>
<li><a href="https://doi.org/10.21105/joss.03358" class="external-link"><img src="https://joss.theoj.org/papers/10.21105/joss.03358/status.svg" alt="DOI"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Lluís Revilla Sancho.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
